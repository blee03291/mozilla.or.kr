<?php
$replace_rule = array(
  // Document title
  array(
    'source' => '<title>Mozilla — Home of the Mozilla Project — mozilla.org</title>', 
    'target' => '<title>Mozilla - Mozilla 프로젝트</title>'), 
  // Main contents
  array(
    'source' => 'Doing good is part of our code', 
    'target' => '웹으로 세상을 바꾸고 있습니다!'), 
  array(
    'source' => 'Different by&nbsp;Design', 
    'target' => '새로운 디자인'), 
  array(
    'source' => 'Proudly <br> non-profit', 
    'target' => '비영리<br> 웹브라우저'), 
  array(
    'source' => 'Innovating <br> for&nbsp;you', 
    'target' => '사용자로부터<br> 기술 혁신'), 
  array(
    'source' => 'Fast,&nbsp;flexible, <br> secure', 
    'target' => '빠르고<br> 보안 강화'), 
  array(
    'source' => '<a href="/en-US/firefox/os/" class="container">', 
    'target' => '<a href="/ko/firefox/os/" class="container">'), 
  array(
    'source' => 'Look ahead', 
    'target' => '미래를 봅니다!'), 
  array(
    'source' => 'Firefox OS lets you live every moment to its fullest and build a brighter future for the Web.', 
    'target' => 'Firefox OS는 여러분 삶의 순간 마다 더 나은 경험을 제공하는 동시에 웹의 미래를 더 밝게 합니다.'), 
  array(
    'source' => 'Find out how', 
    'target' => '자세히 보기'), 
  array(
    'source' => 'Did you know?', 
    'target' => '알고 계신가요?'), 
  array(
    'source' => 'From June 15 &ndash; September 15, thousands of Mozillians worldwide are throwing parties to make and share amazing projects.', 
    'target' => '6월 15일 부터 9월 15일까지 전세계 수만은 Mozillian들이 멋진 프로젝트를 만들고 공유하기 위한 파티를 엽니다.'), 
  array(
    'source' => 'Join us', 
    'target' => '참여하기'), 
  array(
    'source' => 'Choose your favorites', 
    'target' => '좋아하는 작품을 골라 보세요.'), 
  array(
    'source' => 'August 31 is the last day to vote for the People‘s Choice Awards. Don‘t miss your chance.', 
    'target' => '8월 31일은 사람들이 선택한 작품에 투표하는 마지막 기한입니다. 기회를 놓치지 마세요.'), 
  array(
    'source' => 'Vote now', 
    'target' => '투표하기'), 
  array(
    'source' => 'Fast. Smart. Safe.', 
    'target' => '빠름. 똑똑함. 안전함.'), 
  array(
    'source' => 'Get the mobile browser that’s got your back.', 
    'target' => '모바일용 웹 브라우저를 체험해 보세요.'), 
  array(
    'source' => 'Get Firefox for Android', 
    'target' => 'Firefox for Android 다운로드'), 
  array(
    'source' => 'In the news', 
    'target' => '새로운 뉴스'), 
  array(
    'source' => '<a href="https://blog.mozilla.org/" id="all-news">See all news', 
    'target' => '<a href="/community/" id="all-news">뉴스 더 보기'), 
  array(
    'source' => '<section id="home-promos">
    <h3>In the know</h3>
     <ul>
      <li>
        <h4><a href="/en-US/firefox/os/">Firefox OS</a></h4>
        <p>See what’s next for the mobile Web.</p>
      </li>
      <li>
        <h4><a href="https://affiliates.mozilla.org/">Become an Affiliate</a></h4>
        <p>Help us share Firefox with the world!</p>
      </li>
      <li>
        <h4><a href="/en-US/apps/">Firefox Marketplace</a></h4>
        <p>Launch your app on the web</p>
      </li>
    </ul>
  </section>', 
    'target' => '<section id="home-promos">
    <h3>주요 프로젝트</h3>
     <ul>
      <li>
        <h4><a href="/ko/firefox/features/">Firefox 데스크톱</a></h4>
        <p>윈도/맥/리눅스 모두를 지원하는 오픈 웹 브라우저</p>
      </li>
      <li>
        <h4><a href="/ko/firefox/mobile/features/">Firefox 안드로이드버전</a></h4>
        <p>안드로이드에서도 빠르고 안전한 맞춤 브라우저</p>
      </li>
      <li>
        <h4><a href="/ko/firefox/os/">Firefox OS</a></h4>
        <p>새로운 개방형 모바일 웹 운영 체제(OS)</p>
      </li>
      <li>
        <h4><a href="/ko/apps/">Firefox Marketplace</a></h4>
        <p>웹개발자가 만든 웹앱을 다양한 채널로 배포 가능</p>
      </li>
    </ul>
  </section>'), 
  array(
    'source' => '<section id="home-about">
    <h3>Be a part of Mozilla</h3>
    <ul>
      <li id="about-volunteer"><a href="/en-US/contribute/">
        <h4>Volunteer with us</h4>
        <p>Get involved in any area of the Mozilla Project.</p>
      </a></li>
      <li id="about-work"><a href="http://careers.mozilla.org/">
        <h4>Work with us</h4>
        <p>Apply today and love the Web for a living.</p>
      </a></li>
      <li id="about-find"><a href="/en-US/about/mozilla-spaces/">
        <h4>Find us</h4>
        <p>Contact one of our global Mozilla Spaces.</p>
      </a></li>
      <li id="about-join"><a href="https://sendto.mozilla.org/Join-Moz-Org">
        <h4>Donate</h4>
        <p>Show your support and help us build a better Web.</p>
      </a></li>
      <li id="about-learn"><a href="/en-US/about/">
        <h4>Learn more</h4>
        <p>Get to know Mozilla a little bit better.</p>
      </a></li>
    </ul>
  </section>', 
    'target' => '<section id="home-about">
    <h3>참여 하기</h3>
    <ul>
      <li id="about-find"><a href="/ko/contribute/">
        <h4>글로벌 참여 하기</h4>
        <p>Mozilla Project의 다양한 영역을 알려드립니다.</p>
      </a></li>
      <li id="about-volunteer"><a href="/community/join">
        <h4>한국 커뮤니티</h4>
        <p>국내 Mozilla 활동 및 참여 방법을 소개합니다.</p>
      </a></li>
      <li id="about-work"><a href="http://forums.mozilla.or.kr">
        <h4>사용자 포럼</h4>
        <p>일반 사용자 질문 및 답변, 정보 공유 공간입니다.</p>
      </a></li>
      <li id="about-learn"><a href="/ko/about/">
        <h4>더 자세히 보기</h4>
        <p>Mozilla에 대한 더 상세한 정보를 살펴보세요.</p>
      </a></li>
    </ul>
  </section>'), 
);

$xml_source = file_get_contents("http://www.mozilla.or.kr/community/feed");
$x = simplexml_load_string($xml_source);
$i = 0;
$news_html = '';
foreach($x->channel->item as $item) {
  if($i < 4) {
    $news_html .= '<li><h4><a href="'.$item->link.'">'.$item->title.'</a></h4></li>';
    $i++;
  }
}

$insert_rule = array(
  array(
    'before' => '<h3>새로운 뉴스</h3>', 
    'after' => '<a href="/community/" id="all-news">뉴스 더 보기', 
    'insert' => $news_html
  ), 
);

$remove_rule = array(
  array(
    'start' => '<form class="billboard newsletter-form"', 
    'end' => '<small>We will only send you Mozilla-related information.</small></p>
  </div>
</form>'
  ), 
);

require_once($_SERVER['DOCUMENT_ROOT'] . '/lib/MozKr.class.php');
require_once($_SERVER['DOCUMENT_ROOT'] . '/lib/common_rules.php');
$t = new MozKr('http://www.mozilla.org/en-US/', 'http://www.mozilla.or.kr/ko/', $replace_rule, $insert_rule, $remove_rule);
echo($t->get_content());
?>
